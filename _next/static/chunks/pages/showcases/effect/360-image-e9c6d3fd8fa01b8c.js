(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{2963:function(e,t,r){"use strict";r.d(t,{Z:function(){return k}});var n=r(7462),o=r(3366),a=r(7294);r(6607);var i=r(6010),s=r(4780),l=r(948),c=r(1657),d=r(5861),u=r(1796),m=r(8169),h=r(5893),f=(0,m.Z)((0,h.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz"),p=r(7739);let x=(0,l.ZP)(p.Z)(({theme:e})=>(0,n.Z)({display:"flex",marginLeft:`calc(${e.spacing(1)} * 0.5)`,marginRight:`calc(${e.spacing(1)} * 0.5)`},"light"===e.palette.mode?{backgroundColor:e.palette.grey[100],color:e.palette.grey[700]}:{backgroundColor:e.palette.grey[700],color:e.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,n.Z)({},"light"===e.palette.mode?{backgroundColor:e.palette.grey[200]}:{backgroundColor:e.palette.grey[600]}),"&:active":(0,n.Z)({boxShadow:e.shadows[0]},"light"===e.palette.mode?{backgroundColor:(0,u._4)(e.palette.grey[200],.12)}:{backgroundColor:(0,u._4)(e.palette.grey[600],.12)})})),g=(0,l.ZP)(f)({width:24,height:16});var v=function(e){return(0,h.jsx)("li",{children:(0,h.jsx)(x,(0,n.Z)({focusRipple:!0},e,{ownerState:e,children:(0,h.jsx)(g,{ownerState:e})}))})},y=r(1588),b=r(4867);function j(e){return(0,b.Z)("MuiBreadcrumbs",e)}let w=(0,y.Z)("MuiBreadcrumbs",["root","ol","li","separator"]),M=["children","className","component","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],S=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},j,t)},P=(0,l.ZP)(d.Z,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,t)=>[{[`& .${w.li}`]:t.li},t.root]})({}),E=(0,l.ZP)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,t)=>t.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),Z=(0,l.ZP)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,t)=>t.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8}),_=a.forwardRef(function(e,t){var r,s;let l=(0,c.Z)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:u,component:m="nav",expandText:f="Show path",itemsAfterCollapse:p=1,itemsBeforeCollapse:x=1,maxItems:g=8,separator:y="/"}=l,b=(0,o.Z)(l,M),[j,w]=a.useState(!1),_=(0,n.Z)({},l,{component:m,expanded:j,expandText:f,itemsAfterCollapse:p,itemsBeforeCollapse:x,maxItems:g,separator:y}),k=S(_),C=a.useRef(null),R=a.Children.toArray(d).filter(e=>a.isValidElement(e)).map((e,t)=>(0,h.jsx)("li",{className:k.li,children:e},`child-${t}`));return(0,h.jsx)(P,(0,n.Z)({ref:t,component:m,color:"text.secondary",className:(0,i.Z)(k.root,u),ownerState:_},b,{children:(0,h.jsx)(E,{className:k.ol,ref:C,ownerState:_,children:(r=j||g&&R.length<=g?R:(e=>{let t=()=>{w(!0);let e=C.current.querySelector("a[href],button,[tabindex]");e&&e.focus()};return x+p>=e.length?e:[...e.slice(0,x),(0,h.jsx)(v,{"aria-label":f,onClick:t},"ellipsis"),...e.slice(e.length-p,e.length)]})(R),s=k.separator,r.reduce((e,t,n)=>(n<r.length-1?e=e.concat(t,(0,h.jsx)(Z,{"aria-hidden":!0,className:s,ownerState:_,children:y},`separator-${n}`)):e.push(t),e),[]))})}))});var k=_},3023:function(e,t){"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen"),Symbol.for("react.module.reference")},6607:function(e,t,r){"use strict";r(3023)},8633:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/showcases/effect/360-image",function(){return r(2799)}])},2799:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return H}});var n,o,a=r(5893),i=r(7294),s=r(9008),l=r.n(s),c=r(1664),d=r.n(c),u=r(7357),m=r(5582),h=r(6886),f=r(2963),p=r(5861),x=r(3946),g=r(7814),v=r(9417),y=r(3636);r(6656);var b=r(9477),j=r(9136),w=r(5029),M=r(4671);let S=0,P=(0,M.Z)(e=>(b.DefaultLoadingManager.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-S)/(n-S)*100})},b.DefaultLoadingManager.onLoad=()=>{e({active:!1})},b.DefaultLoadingManager.onError=t=>e(e=>({errors:[...e.errors,t]})),b.DefaultLoadingManager.onProgress=(t,r,n)=>{r===n&&(S=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-S)/(n-S)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));var E=r(7462),Z=r(745);let _=new b.Vector3,k=new b.Vector3,C=new b.Vector3;function R(e,t,r){let n=_.setFromMatrixPosition(e.matrixWorld);n.project(t);let o=r.width/2,a=r.height/2;return[n.x*o+o,-(n.y*a)+a]}let W=e=>1e-10>Math.abs(e)?0:e;function F(e,t,r=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=W(t[r]*e.elements[r])+(15!==r?",":")");return r+n}let I=(n=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>F(e,n)),$=(o=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>F(e,o(t),"translate(-50%,-50%)")),T=i.forwardRef(({children:e,eps:t=.001,style:r,className:n,prepend:o,center:a,fullscreen:s,portal:l,distanceFactor:c,sprite:d=!1,transform:u=!1,occlude:m,onOcclude:h,castShadow:f,receiveShadow:p,material:x,geometry:g,zIndexRange:v=[16777271,0],calculatePosition:y=R,as:w="div",wrapperClass:M,pointerEvents:S="auto",...P},F)=>{let{gl:T,camera:z,scene:L,size:N,raycaster:A,events:B,viewport:H}=(0,j.z)(),[D]=i.useState(()=>document.createElement(w)),V=i.useRef(),G=i.useRef(null),O=i.useRef(0),X=i.useRef([0,0]),K=i.useRef(null),q=i.useRef(null),U=(null==l?void 0:l.current)||B.connected||T.domElement.parentNode,Q=i.useRef(null),Y=i.useRef(!1),J=i.useMemo(()=>{var e;return m&&"blending"!==m||Array.isArray(m)&&m.length&&(e=m[0])&&"object"==typeof e&&"current"in e},[m]);i.useLayoutEffect(()=>{let e=T.domElement;m&&"blending"===m?(e.style.zIndex=`${Math.floor(v[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[m]),i.useLayoutEffect(()=>{if(G.current){let e=V.current=Z.createRoot(D);if(L.updateMatrixWorld(),u)D.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=y(G.current,z,N);D.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return U&&(o?U.prepend(D):U.appendChild(D)),()=>{U&&U.removeChild(D),e.unmount()}}},[U,u]),i.useLayoutEffect(()=>{M&&(D.className=M)},[M]);let ee=i.useMemo(()=>u?{position:"absolute",top:0,left:0,width:N.width,height:N.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:a?"translate3d(-50%,-50%,0)":"none",...s&&{top:-N.height/2,left:-N.width/2,width:N.width,height:N.height},...r},[r,a,s,N,u]),et=i.useMemo(()=>({position:"absolute",pointerEvents:S}),[S]);i.useLayoutEffect(()=>{var t,o;Y.current=!1,u?null==(t=V.current)||t.render(i.createElement("div",{ref:K,style:ee},i.createElement("div",{ref:q,style:et},i.createElement("div",{ref:F,className:n,style:r,children:e})))):null==(o=V.current)||o.render(i.createElement("div",{ref:F,style:ee,className:n,children:e}))});let er=i.useRef(!0);(0,j.A)(e=>{if(G.current){z.updateMatrixWorld(),G.current.updateWorldMatrix(!0,!1);let e=u?X.current:y(G.current,z,N);if(u||Math.abs(O.current-z.zoom)>t||Math.abs(X.current[0]-e[0])>t||Math.abs(X.current[1]-e[1])>t){let t=function(e,t){let r=_.setFromMatrixPosition(e.matrixWorld),n=k.setFromMatrixPosition(t.matrixWorld),o=r.sub(n),a=t.getWorldDirection(C);return o.angleTo(a)>Math.PI/2}(G.current,z),r=!1;J&&("blending"!==m?r=[L]:Array.isArray(m)&&(r=m.map(e=>e.current)));let n=er.current;if(r){let e=function(e,t,r,n){let o=_.setFromMatrixPosition(e.matrixWorld),a=o.clone();a.project(t),r.setFromCamera(a,t);let i=r.intersectObjects(n,!0);if(i.length){let e=i[0].distance,t=o.distanceTo(r.ray.origin);return t<e}return!0}(G.current,z,A,r);er.current=e&&!t}else er.current=!t;n!==er.current&&(h?h(!er.current):D.style.display=er.current?"block":"none");let o=Math.floor(v[0]/2),a=m?J?[v[0],o]:[o-1,0]:v;if(D.style.zIndex=`${function(e,t,r){if(t instanceof b.PerspectiveCamera||t instanceof b.OrthographicCamera){let n=_.setFromMatrixPosition(e.matrixWorld),o=k.setFromMatrixPosition(t.matrixWorld),a=n.distanceTo(o),i=(r[1]-r[0])/(t.far-t.near),s=r[1]-i*t.far;return Math.round(i*a+s)}}(G.current,z,a)}`,u){let[e,t]=[N.width/2,N.height/2],r=z.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:o,left:a,bottom:i,right:s}=z,l=I(z.matrixWorldInverse),u=n?`scale(${r})translate(${W(-(s+a)/2)}px,${W((o+i)/2)}px)`:`translateZ(${r}px)`,m=G.current.matrixWorld;d&&((m=z.matrixWorldInverse.clone().transpose().copyPosition(m).scale(G.current.scale)).elements[3]=m.elements[7]=m.elements[11]=0,m.elements[15]=1),D.style.width=N.width+"px",D.style.height=N.height+"px",D.style.perspective=n?"":`${r}px`,K.current&&q.current&&(K.current.style.transform=`${u}${l}translate(${e}px,${t}px)`,q.current.style.transform=$(m,1/((c||10)/400)))}else{let t=void 0===c?1:function(e,t){if(t instanceof b.OrthographicCamera)return t.zoom;if(!(t instanceof b.PerspectiveCamera))return 1;{let r=_.setFromMatrixPosition(e.matrixWorld),n=k.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,a=r.distanceTo(n);return 1/(2*Math.tan(o/2)*a)}}(G.current,z)*c;D.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}X.current=e,O.current=z.zoom}}if(!J&&Q.current&&!Y.current){if(u){if(K.current){let e=K.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=z;if(t||g)P.scale&&(Array.isArray(P.scale)?P.scale instanceof b.Vector3?Q.current.scale.copy(P.scale.clone().divideScalar(1)):Q.current.scale.set(1/P.scale[0],1/P.scale[1],1/P.scale[2]):Q.current.scale.setScalar(1/P.scale));else{let t=(c||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;Q.current.scale.set(r,n,1)}Y.current=!0}}}else{let t=D.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/H.factor,r=t.clientWidth*e,n=t.clientHeight*e;Q.current.scale.set(r,n,1),Y.current=!0}Q.current.lookAt(e.camera.position)}}});let en=i.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return i.createElement("group",(0,E.Z)({},P,{ref:G}),m&&!J&&i.createElement("mesh",{castShadow:f,receiveShadow:p,ref:Q},g||i.createElement("planeGeometry",null),x||i.createElement("shaderMaterial",{side:b.DoubleSide,vertexShader:en.vertexShader,fragmentShader:en.fragmentShader})))});var z=r(5823),L=r(9339),N=r(487),A=r(1873),B=r.n(A);function H(e){let{Component:t,pageProps:r}=e,[n,o]=(0,i.useState)("75vh"),[s,c]=(0,i.useState)(!1),y=()=>{let e=(0,j.D)(b.TextureLoader,"/showcase/assets/images/effect/threejs/360image-sea.jpg");return e.center=new b.Vector2(.5,.5),e.rotation=Math.PI,e.flipY=!1,(0,a.jsxs)("mesh",{children:[(0,a.jsx)("sphereBufferGeometry",{attach:"geometry",args:[800,60,40]}),(0,a.jsx)("meshBasicMaterial",{attach:"material",map:e,side:b.BackSide})]})},M=()=>{!0===s?E():S()},S=()=>{var e=document.getElementById("360image-canvas");null==e||e.requestFullscreen(),c(!0),o("100vh")},E=()=>{document.exitFullscreen(),c(!1),o("75vh")},Z=()=>{let{progress:e}=P(),t=e.toFixed(2);return(0,a.jsx)(T,{children:(0,a.jsxs)("p",{className:"".concat(B().ThreejsLoader),children:[t,"%"]})})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"360\xb0 Image with Three.js | Showcase @ksin8909"}),(0,a.jsx)("meta",{name:"description",content:"Showcase @ksin8909"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/showcase/favicon.ico"})]}),(0,a.jsxs)(u.Z,{component:"div",sx:{display:"flex",flexDirection:"column"},children:[(0,a.jsx)(L.Z,{...r,isHome:!1}),(0,a.jsxs)(m.Z,{maxWidth:"xl",sx:{pb:4},children:[(0,a.jsxs)(f.Z,{separator:"â€º","aria-label":"breadcrumb",sx:{py:3},children:[(0,a.jsx)(d(),{href:"/",children:"Home"}),(0,a.jsx)(d(),{href:"/showcases",children:"Showcases"}),(0,a.jsx)(d(),{href:"/showcases?category=Effect",children:"Effect"}),(0,a.jsx)(p.Z,{children:"360\xb0 Image with Three.js"})]}),(0,a.jsx)(p.Z,{variant:"h2",component:"h2",textAlign:"center",className:"".concat(B().Header),children:"360\xb0 Image with Three.js"})]}),(0,a.jsx)(h.ZP,{container:!0,children:(0,a.jsx)(h.ZP,{item:!0,xs:12,textAlign:"center",children:(0,a.jsxs)(u.Z,{component:"div",id:"360image-canvas",children:[(0,a.jsx)(u.Z,{component:"div",children:(0,a.jsxs)(w.Xz,{onDoubleClick:M,camera:{position:[0,0,.01]},style:{width:"100%",height:n},children:[(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)(Z,{}),children:(0,a.jsx)(y,{})}),(0,a.jsx)(z.z,{enableZoom:!0,enablePan:!0,enableDamping:!0,dampingFactor:.2,autoRotate:!0,rotateSpeed:-.05})]})}),!0===s?(0,a.jsx)(u.Z,{component:"div",className:"".concat(B().Image360ExitFullscreen),children:(0,a.jsx)(x.Z,{onClick:E,children:(0,a.jsx)(g.G,{icon:v.Qj4})})}):(0,a.jsx)(u.Z,{component:"div",className:"".concat(B().Image360GoFullscreen),children:(0,a.jsx)(x.Z,{onClick:S,children:(0,a.jsx)(g.G,{icon:v.TL5})})})]})})}),(0,a.jsx)(N.Z,{})]})]})}y.vc.autoAddCss=!1},1873:function(e){e.exports={Header:"Effect_Header__Rs7Ax",Chip:"Effect_Chip__jMtK2",Link:"Effect_Link__8S_aK",ThreejsLoader:"Effect_ThreejsLoader__IUVKE",Image360GoFullscreen:"Effect_Image360GoFullscreen__EXUVe",Image360ExitFullscreen:"Effect_Image360ExitFullscreen__WoVPL"}}},function(e){e.O(0,[976,948,737,267,783,126,774,888,179],function(){return e(e.s=8633)}),_N_E=e.O()}]);